!function(){let e=e=>Math.floor(Math.random()*e),t=(e,t)=>e.reduce((e,n,s)=>(e[Math.floor(t?s%e.length:s/e.length)].push(n),e),[[],[],[],[]]),n=e=>t([...e],!0),s=e=>t([...e]),l=e=>[...e].reduce((e,t)=>+t.textContent>2?e+ +t.textContent:e+0,0),r=(e,t)=>[...e].some((e,n)=>!e.isEqualNode(t.flat()[n])),o=e=>[...e].some(e=>""===e.textContent),a=e=>{for(let t of[...s(e),...n(e)])for(let e=0;e<t.length;e++)if(t[e].isEqualNode(t[e+1]))return!0},c=e=>!o(e)&&!a(e),d=e=>[...e].some(e=>2048==+e.textContent),i=e=>{let t=e.classList.item(1);t&&e.classList.remove(t)},u=(e,t)=>{i(e),e.textContent=t,e.classList.add(`field-cell--${t}`)},h=()=>{[...M].forEach(e=>{e.textContent=null,i(e)})},m=()=>{let e=document.createElement("td");return e.classList.add("field-cell"),e},f=()=>{let t=q[e(4)].children[e(4)];t.textContent?f():u(t,.1>Math.random()?4:2)},L=(e,t)=>{i(e),e.classList.add(t.toLowerCase()),e.textContent=t},v=e=>{[...q].forEach((t,n)=>{t.innerHTML="",t.append(...e[n])}),f()},C=e=>{let t=[];for(let n=0;n<e.length;){let s=e[n],l=e[n+1];l&&s.isEqualNode(l)&&(u(s,2*+s.textContent),n++),n++,t.push(s)}return t},E=(e,t)=>e.map(e=>{let n=C(e.filter(e=>e.textContent&&e)),s=Array.from({length:4-n.length},()=>m());return t?s.concat(n):n.concat(s)}),g=(e,t)=>{let n=E(e,t);r(M,n)&&v(n)},x=(e,n)=>{let s=t(E(e,n).flat(),!0);r(M,s)&&v(s)},k=()=>{x(n(M))},w=()=>{x(n(M),!0)},y=()=>{g(s(M))},p=()=>{g(s(M),!0)},q=document.getElementsByClassName("field-row"),M=document.getElementsByClassName("field-cell"),b=document.querySelector(".button"),A=document.querySelectorAll(".message"),N=document.querySelector(".game-score"),S=!1,T=()=>{b.removeEventListener("click",T),h(),N.textContent=0,L(b,"Start"),A[0].classList.add("hidden"),A[1].classList.add("hidden"),A[2].classList.remove("hidden"),b.addEventListener("click",B),S=!1},B=()=>{b.removeEventListener("click",B),f(),L(b,"Restart"),b.addEventListener("click",T),A[2].classList.add("hidden"),S=!0};b.addEventListener("click",B),document.addEventListener("keydown",e=>{if(S){if(c(M)){A[0].classList.remove("hidden"),S=!1;return}switch(e.key){case"ArrowUp":k();break;case"ArrowDown":w();break;case"ArrowLeft":y();break;case"ArrowRight":p()}N.textContent=l(M),d(M)&&(A[1].classList.remove("hidden"),S=!1)}});let D=document.querySelector(".game-field"),R=0,X=0,Y=0,H=0;D.addEventListener("touchstart",e=>{e.preventDefault(),R=e.touches[0].clientX,X=e.touches[0].clientY}),D.addEventListener("touchend",e=>{Y=e.changedTouches[0].clientX,H=e.changedTouches[0].clientY,function(){if(!S)return;if(c(M)){A[0].classList.remove("hidden"),S=!1;return}let e=Y-R,t=H-X;Math.abs(e)>Math.abs(t)?e>25?p():e<-25&&y():t>25?w():t<-25&&k(),N.textContent=l(M),d(M)&&(A[1].classList.remove("hidden"),S=!1)}()})}();
//# sourceMappingURL=index.ce7dcdc9.js.map
